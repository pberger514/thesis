\chapter{\label{chap:hol} Holography}
 
%\usepackage{amsmath,amsfonts,amssymb}
%\usepackage{graphicx}
%\usepackage[colorlinks=true, allcolors=blue]{hyperref}
%\usepackage{caption}
%\usepackage{subcaption}


%\title{Holographic Beam Mapping of the CHIME Pathfinder Array}

This chapter follows the structure of 
\newline
\newline
Berger, P., Newburgh, L. B., Amiri, M., et al. 2016, ``\textit{Holographic Beam Mapping of the CHIME Pathfinder Array},'' in Proc. SPIE, Vol. 9906, Ground-based and Airborne Telescopes VI, 99060D,
\newline
\newline
although many more recent updates are added. For example, the chapter includes large modifications to the absolute calibration and averaging algorithm to minimize spurrious spectral structure, more realistic simulations of the holography observations, and a section discussing the evidence for a multi-bounce model for the beam.

\newpage

\section{Introduction} \label{ch:hol:sec:intro}

The Canadian Hydrogen Intensity Mapping Experiment (CHIME) is a new cylindrical transit interferometer currently being deployed at the Dominion Radio Astrophysical Observatory (DRAO) in Penticton, British Columbia. A smaller, two cylinder test-bed -- the CHIME Pathfinder -- has been built and instrumented with 128 dual polarisation dipole antennas and a custom FX correlator and is currently surveying the Northern hemisphere in 1024 frequency bands between 400 and 800 MHz. The Pathfinder correlator performs the full $N^2$ operation of correlating each of its 256 inputs at each frequency channel. See Ref. \citep{chimepath1} for details of the design of the Pathfinder, Refs. \citep{xeng1, xeng2, xeng3} for details on the GPU based X-engine, and Ref. \citep{chimepath2} for a description of the calibration methodology.

As a transit interferometer, CHIME monitors the entire Northern sky visible from the DRAO each night. The telescope is optimized for 21 cm intensity mapping at redshifts $0.8-2.5$ where tomography of the large-scale distribution of neutral hydrogen (HI) will allow for a time-dependent measurement of the Baryon Acoustic Oscillations (BAO). The result will provide constraints on the time evolution of Dark Energy, including the epoch where it begins to dominate the energy density of the universe and so influences its expansion \citep{furl, moraleswyithe, bao1}. To do so, we must contend with astrophysical foregrounds, notably the synchrotron emission of the Milky Way, which are some five orders of magnitude brighter than the HI signal \citep{santoscoorayknox}. Removal of foregrounds is possible due to their smooth spectral nature versus the 21 cm signal, which should be relatively uncorrelated in frequency \citep{santoscoorayknox, mmodes1, mmodes2}. 

Foreground filtering is only possible with precise instrument characterization. Uncertainty in the primary beam leads to mode mixing, converting small-scale angular power into frequency structure. Uncertainty in the polarized response of the telescope leads to leakage of polarised signal into total intensity. Both of these effects can easily overwhelm the 21 cm signal. In Ref. \citep{mmodes2}, these statements are made quantitative via fully polarized end-to-end simulations of a CHIME-like cylinder telescope. By varying the full width at half power of the illuminating dipole feed, the authors set the specification required for an unbiased estimate of the 21 cm power spectrum to $0.1\%$ of this parameter.

In this chapter, we describe progress in mapping the full two-dimensional primary beam of each feed and frequency of the CHIME pathfinder array through a technique known as point-source holography \citep{radio1, radio2}. Holography is a well-known technique in radio astronomy and has been used with success in the near \citep{hol1} and far field \citep{hol2} to obtain high-resolution measurements on single-dish telescopes and dish arrays. Holographic techniques have further been used to map direction dependent polarisation leakages \citep{holpol}. In holography we track a bright point source with one telescope as a reference beam and correlate the signal with another telescope that is stationary. As the source transits, we measure a one-dimensional track through the stationary antenna beam. To serve as our tracking dish, we have equipped the John A. Galt 26 m telescope\citep{wolleben1, wolleben2} (hereafter 26 m), an equatorially mounted 26 meter diameter parabolic telescope also located at the DRAO, with a separate $400-800$ MHz receiver chain which is fed into the CHIME Pathfinder correlator. This allows correlation of its signal with the Pathfinder array. Since the Pathfinder is a fixed transit telescope, we observe sources at multiple declinations to obtain information on the North-South (NS) response of the beam. By averaging multiple transits from each source, we obtain high signal-to-noise, good angular resolution measurements of all 256 beams in both amplitude and phase. We have collected a preliminary data set, which allows for development and validation of the holographic analysis pipeline and initial results, that we present here.

The chapter is organized as follows. In Section \ref{ch:hol:sec:io}, we describe the Pathfinder and 26 m instruments and the observations and data included here. In Section \ref{ch:hol:sec:data}, we outline the holographic data cleaning and treatment method, including the algorithms to interpolate the observations onto an estimate of the full two-dimensional beam. In Section \ref{ch:hol:sec:analysis}, we provide analysis of both the raw and processed data, including comparison to electromagnetic simulations and a discussion of evidence for a first-principles model of the CHIME beam. Finally, in Section \ref{ch:hol:sec:sims} we discuss the results of full-sky simulations of the holographic measurement process which we have conducted to assess the effect of various systematics on the reconstruction of the beam, notably the effects of background contamination and spatial structure in the targeted sources.


\section{Instrument and Observations} \label{ch:hol:sec:io}

\subsection{Instrument} \label{ch:hol:sec:io:ss:i}

The CHIME Pathfinder\citep{chimepath1} consists of two $20\times37$ m$^2$ parabolic cylinders which are open North-South (NS) and focus incoming light East-West (EW). It is instrumented with 128 dual polarisation cloverleaf dipole feeds\citep{meiling}, 64 along the focal line of each cylinder, spaced by $0.3$ m. The illumination pattern of the two polarisations is known to be slightly elliptical so that the E-plane full width at half maximum (FWHM) of the NS polarisation is less wide than its H-plane, and vice versa for the EW polarisation. Therefore the FWHM of an EW slice of the NS polarisation is expected to be sharper than the EW polarisation. In general, we expect the main beam to be on the order of a degree in the EW direction, and to extend from horizon to horizon in the NS direction. The output of the Pathfinder correlator is a data cube of visibilities whose axes are frequency, cross-correlation, and time. In its nominal acquisition mode, it integrates from the sampling cadence of $2.56~\mu s$ to 20 s. However, in holography mode we sample at 10 s to ensure we well resolve the fringe rate of the Pathfinder-26 m baseline, which is about 150 m.

In error, the Pathfinder cylinders were aligned with Map Grid North which, at Penticton, is 1.9 degrees from celestial North. This alignment is accounted for in the analysis presented here. Another lesson learned from construction of the Pathfinder is that a poor choice of the form of the surface material lead to scalloping of the surface and medium-scale distortions which are larger than desired. In the following, particularly in Section \ref{ch:hol:sec:results:ss:fullarray}, we will see evidence that these distortions have an important impact on the resulting beam shape. Neither of these errors was repeated on the full-scale CHIME telescope.

For the measurements presented in this document we deployed custom $400-800$ MHz instrumentation at the focus of the 26 m telescope. The signal chain is depicted in Figure \ref{26mplot} (right) and consists of: a CHIME cloverleaf feed in a waveguide cavity with a flange and choke ring designed to symmetrize the polarized beams across the CHIME radio band; a pair of CHIME low noise amplifiers; an additional amplification stage at the focus; 100 m of RG214 cable; a set of ZFL-1000H+ Minicircuits amplifiers; 200 m of LMR400 cable; a final band pass filter amplifier stage; and finally the 26 m signal is digitized in the CHIME correlator.

\begin{figure}[h!] % not h only
	\centering
	\begin{subfigure}[a]{0.42\textwidth}
		\vspace{-4in}
		\includegraphics[width=\textwidth]{figures/spie/26m_widths.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.56\textwidth}%
		\includegraphics[width=\textwidth]{figures/spie/26m_schematic_20160704.png}%
		\label{signalchain}
	\end{subfigure}%
	\caption{(Left) The FWHM of the 26 m beam as measured from drift scans centered on three different sources: Cygnus A, Cassiopeia A, and Taurus A. (Right) The analog signal chain of the 26 m instrument.}
	\label{26mplot}
\end{figure}

The telescope source equivalent flux density (SEFD) is expected to be $\sim$440 Jy, dominated by the first stage amplifier ($\sim$40 dB gain, $\sim$35 K noise temperature), and the instrument resolution should be $\sim1.5^{\circ}$ in the centre of the CHIME band. The beam and noise properties were measured with a set of drift scans and tracking scans of Virgo A, Cygnus A, Taurus A, and Casseiopiea A. A Gaussian profile was fit to the drift scans, and the resulting frequency-dependent FWHM values for both polarisations are shown in Figure \ref{26mplot} (left) for the drift scans of CygA, CasA, and TauA. The beam widths are in rough agreement with a simple model, but become slightly wider at low frequencies and differ more between polarisations at high frequencies than expected. In the single 1D slice from the drift scan, the FWHM of the two different polarisations are equal at high frequencies but differ at low frequencies by $\sim$6\%, compared to the expected 4\%. There is also a clear ripple in the FWHM, whose period is consistent with twice the path-length between the vertex and the focus of the dish (15.6 m, or 19.2 MHz). This standing-wave has been noted by other groups in the past on other wide band radio instruments \citep{wander1, wander2}.

Estimates of the noise temperature and resulting SEFD were calculated using various combinations of the above sources from both drifting and tracking scans, and are consistent with the expected value of 440Jy. However, there is a spread between measurements from different celestial sources of about 100Jy in the centre of the CHIME band, which will be the topic of further investigation.

\subsection{Observations} \label{ch:hol:sec:io:ss:o}

To measure the NS beam shape, we must use multiple point sources at different declinations. Table \ref{tab1} lists the sources chosen, as well as their positions and the number of observations used in the present analysis. For the observations included in Ref. \citep{bergernewburgh}, the majority of these were conducted between mid February and early March 2016. However, a number of preliminary observations were made more than half a year earlier, in July 2015. The sources were chosen by ranking the brightest sources above the horizon of the Pathfinder, then selecting based on the need for night time observing. For this reason the Cygnus A and Caseopeia A observations considered here were are taken from a later observing period in October 2016. Since these periods, a large holography observing campaign has been undertaken collecting hundreds of observations of the listed sources. However, (aside from the Cygnus A and Caseopeia A observations) for this analysis we restrict ourselves to the dataset contained in Ref. \citep{bergernewburgh}, since these are sufficient for development and testing of a pipeline capable of processing the full set. Futhermore for this analysis we don't apply time-dependent gain correction, and so for the brightest sources the thermal noise from a single observation exceeds the level of gain fluctuations. This also provides a target sensitivity for the less-bright sources. Observations start by positioning the 26 m on source a few hours before, and ended approximately symmetrically after, the transit of the source. This process is generally a competition between the requirement of observing extended sidelobe structure and maximizing the number of sources observed over the month-long period, which can lead to differing coverage and some asymmetry from night-to-night for a source.

\begin{table}[ht]
\caption{A list of the point sources chosen for the observations, along with the number of observations of each that were combined in the analysis.} 
\label{tab1}
\begin{center}
\begin{tabular}{| c  | c | c | c | c |  }
\hline
 Source  & RA    &        DEC    &  $N_{\rm obs}$ & S($\nu=681$ MHz) \\ \hline
Cygnus A & 299.88  & 40.73  & 2 & $3216 \pm 68$ \\ \hline
Cassiopeia A & 350.85 & 58.83 & 2 & $ 2375 \pm 35 $ \\ \hline
Taurus A & 83.62  & 22.03   & 4  & $1108.0 \pm 0.7$ \\ \hline
Virgo A & 187.71 & 12.39  & 4 & $399 \pm 20$\\ \hline
Hercules A & 252.80   & 4.99  & 2   & $105.8 \pm 2.2$  \\ \hline
Hydra A & 139.52  & -12.09  & 4 & $87.2 \pm 1.4$ \\ \hline
Perseus B  & 69.27  & 29.67  &  3  & $78.7 \pm 1.5$ \\ \hline
3C\_295 & 212.84  & 52.20 & 4   & $38.8 \pm 0.4$\\ \hline
\end{tabular}
\end{center}
\end{table}

\section{Holography pipeline} \label{ch:hol:sec:data}
The primary goal of this analysis is to use measurements of each observed radio source to recover measurements of the primary beam with good angular resolution in the EW direction, at the declination of the point source. In this section we describe the theory, data processing steps, and source information necessary to recover the final estimate of the two-dimensional beam. 

The CHIME Pathfinder correlator records the complex visibilities of a pair of sky channels. Following the notation of Ref. \citep{mmodes1}, we denote the visibilities $V_{ij}$, or correlation between a channel $i$ and $j$ for an unpolarised sky as
\begin{align}
V_{ij}(\nu ; \phi) & \propto \int d^2\hat{n}~A_i(\hat{n}, \nu;\phi)A^*_j(\hat{n}, \nu;\phi) T(\hat{n}) e^{2\pi i \hat{n}\cdot\vec{u}_{ij}(\nu;\phi)},
\label{holvis1}
\\
\rightarrow V_{26,CH} & \propto A_{26}A^*_{CH}(\hat{n}_{\rm ps};\phi) T(\hat{n}_{\rm ps}) e^{2\pi i \hat{n}_{\rm ps}\cdot\vec{u}_{ij}(\phi)},
\label{holvis2}
\end{align}
where $\nu$ is the frequency of observation, $\hat{n}$ is a direction on the sky, and $\phi$ is the celestial polar angle transiting the telescope at a given time of day. $T$ here can be understood as the brightness temperature of the sky although we have omitted the overall normalisation. $A_i$ denotes the primary beam of the $i$th channel. The $\phi$ dependence of $A_i$ highlights that, while the primary beam has some fixed two-dimensional shape, the pointing of the telescope rotates with the earth. Finally, $\vec{u}_{ij}=(\vec{b}_i - \vec{b}_j)/ \lambda$, where $\vec{b}_i$ are the positions vectors of the $i$th feed and $\lambda$ is the wavelength of observation. By definition, the $A_i$ are normalized to 1 on boresight. While the overall telescope response does indeed vary with frequency, this effect is degenerate with the gain of the amplifiers along the analog chain and is not the main focus of these proceedings, which are concerned with the $\hat{n}$ dependence of $A_i$ at each frequency. 

In holography mode, the voltage response of a dish telescope (in our case the 26 m) tracking a bright point source is correlated with that of the transit telescope (in our case the CHIME pathfinder). The integral in Eq. (\ref{holvis1}) collapses since the point source is expressed as a delta function at its sky location $\hat{n}_{\rm ps}$, giving Eq. (\ref{holvis2}) (where we have dropped the explicit frequency dependence). Furthermore, the effect of the tracking dish is constant and the only remaining time dependence, aside from the geometric phase, is the primary beam of the CHIME pathfinder. The visibilities from a holographic transit yield the shape of the Pathfinder primary beam at the declination of the point source.

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{figures/spie/vira_rawdata.png}
\caption{Visibilities of a CHIME-26 m correlation channel for a set of holographic scans of Virgo A, for a single East-West polarisation channel at 681 MHz. Amplitude and phase for the four observations included in the analysis are compared to data from preliminary observations from July 2015. The amplitude has been normalized to one at transit, while the phase has been fringestopped (which normalizes to zero at transit).}
\label{virraw}
\end{figure}

Figure \ref{virraw} displays the raw holographic visibilities from the five Virgo A transits included this analysis, for a single East-West (EW) polarisation channel on the eastern Pathfinder cylinder, in amplitude (left) and phase (right). We recover high signal-to-noise measurements of both the main beam and far sidelobe structure. The results are seen to be reproducible over a period of months. The data are uncorrected except for normalisation and removal of the geometric phase in Eq. (\ref{holvis2}), known as fringestopping. Before fringestopping, the Fourier components of the holographic visibilities occupy a band in Fourier space whose width corresponds to the physical EW width of the Pathfinder cylinder but whose centre corresponds to the Pathfinder-26 m baseline. Fringestopping removes the phase associated to the baseline, which symmetrizes the Fourier components about zero. This establishes the Fourier correspondence between the measured beam pattern and the aperture illumination (discussed at length in Ref. \citep{radio2}, for example).

\subsection{Flagging, pre-filtering, fringestopping}
From the visibility data cube with frequency, baseline, and time axes, we first select the elements corresponding to correlations between the 26 m and Pathfinder channels. Data shown here is such that the feed pairs between CHIME and the 26 m are oriented parallel at transit. Then, a simple flagging for radio frequency interference (RFI) is performed by a median absolute deviation thresholding along the time axis. Next, we perform a delicate high pass filter along the time axis, removing only the lowest frequency modes which are unphysical and can only correspond time independent or slowly varying gains. This is designed to mitigate the effect of gain fluctuations and to protect the phase from spurious signals that would be shifted during fringestopping. This does not affect the peak height of the amplitude at transit. We can then fringestop to the observed source, taking into account the three dimensional position of the 26 m relative to the Pathfinder. We do not normalize the amplitudes because the relative peak heights of the various sources will be used to obtain the NS shape of the beam.

\begin{figure}[h!] % not h only
	\centering
	\begin{subfigure}[b]{0.49\textwidth}%
		\includegraphics[width=\textwidth]{figures/spie/feed13_wns.png}%
	\end{subfigure}%
	\begin{subfigure}[b]{0.47\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/feed13_ens.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.4925\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/feed13_wew.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.4675\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/feed13_eew.png}%
	\end{subfigure}
\caption{The amplitudes of the gridded and averaged visibilities for all sources at 681 MHz for both polarisations of a single antenna near the centre of the West cylinder, and its corresponding antenna on the East cylinder. Regions of one standard deviation are shaded. The offset of the peak of the main beam is due to a 1.9 degree rotation of the Pathfinder cylinder axis from astronomical North.}
\vspace{-.1in}
\label{griddeddata}
\end{figure}

\subsection{Gain Calibration, Gridding, and Averaging}
Due to the thermal dependence of the response of the receiving system Eqs. \ref{holvis1} - \ref{holvis2} should be modified to read
\begin{equation}
V^{\rm meas}_{ij}(\nu, \phi(t)) = g_i(\nu, t)g_j^*(\nu, t)V_{ij}(\nu, \phi) \rightarrow V^{\rm meas}_{26,CH}(\nu, \phi(t)) = g_{26}(\nu, t)g_{CH}^*(\nu, t)V_{26,CH}(\nu, \phi).
\label{visgains}
\end{equation}
The visibilities are multiplied by the complex, time-, and frequency-dependent gains at each feed. If we would like to average the visibilities across observations taken at different times, we should first correct them by estimating and diving out the gains. More mathematical details of this process can be found in Appendix \ref{app:hol:sec:photometry}, however we provide an overview of the algorithm here.

\begin{figure}[h!] % not h only
	\centering
	\includegraphics[width=0.6\textwidth]{figures/spie/treated_phase_ex_viro.png}%
	\caption{The phase of the gridded and averaged beams at 681 MHz for a selected antenna and polarisation for Virgo A. Shaded regions represent regions of one standard deviation of the averaged observations $\sigma_{\arg{A}}$.}
	\label{phaseav}
\end{figure} 

The CHIME-only gains can be estimated through a standard eigendecomposition of the peak response of the visibilities at the transit of a calibrator point source, soon before or after the holographic observation, taking care of the $g_{CH}$ term in Eq. \ref{visgains}. After this stage, as the 26 m is common-mode, the relative gains between feeds at transit are fixed and are seen match well between holographic and CHIME-only visibilites. Choosing a calibrator normalizes the beams to have amplitude 1 and phase 0 at the celestial coordinates of the source, which is equivalent to choosing the origin of the beam coordinate system. Since the CHIME Pathfinder is generally in continuous observation these calibrator transits are readily available. For our observations we choose Taurus A due to its favorable positioning far from the sun during our observation periods. However, the 26 m can not be expected to be in drift-scan mode during all calibrator transits, meaning the array is an a heterogeneous configuration at these times, and the 26 m gain cannot be calibrated out in this way. As holography selects out single-feed components of the visibilities, a holographic observation of the calibrator at its time of transit could serve equally as a reference for the 26 m gains. Although this strategy was adopted for later observations, it was not the case for all data considered here, and so another algorithm was developped free from this requirement. The algorithm performs a linear fit to the phase and a low-order polynomial fit to the amplitude of the frequency-dependence of the holographic peak response after CHIME-only calibration. These fits are then averaged across all transits of the source, and the individual transits are scaled by the ratio of their fit to the average. This scheme is based on a physical understanding of the gains, and is designed to introduce no spurrious spectral structure into the beams. Indeed, the algorithm is limited by the gain drift between calibrator and source transit, but as the times between them are generally only a couple of hourse this a few percent effect. As well, no correction for the effect of the time-dependence of the gains away from transit is applied.

We can then proceed to average across transits, however we first must regrid the visibilities in hour angle onto a common uniform grid, using an inverse Lanczos resampling (see Appendix \ref{app:hol:sec:regrid}). At this point the only input to the noise covariance other than the assumption of constant instrumental noise across frequencies and baselines is RFI flagging, which assigns infinite noise to flagged time samples. We note that the telescope is not sensitive to spatial Fourier modes larger than its width ${\rm w_{EW}}$ in wavelengths
\begin{equation}
m_{\rm max} = 2\pi \frac{\rm w_{EW}}{\lambda},
\end{equation}
where $m$ indexes the Fourier mode conjugate to the azimuthal angle $\phi$. Therefore, we conservatively choose to bin on the angular scale corresponding to $4\times m_{\max}$ at each frequency to ensure these modes are well-sampled and to prevent any binning artifacts. While further binning would produce smoother results, we prefer to leave this work to the averaging procedure. 

We then perform an inverse-variance-weighted average, seperately for the amplitude and phase. We include only sections of beam for which we have collected at least 2 transits. The differing coverage means the final estimate can have different noise properties for different sections. An estimate of the final errors $\sigma_{|A|}$ and $\sigma_{\arg{A}}$ is provided simply by the standard deviation of the non-zero contributions to the averaging.

Figure \ref{griddeddata} displays the amplitudes of the multi-declination results at 681 MHz for both polarisations of a single antenna near the centre of the West cylinder, and its corresponding antenna on the East cylinder. Regions of one standard deviation are shaded. The units of the amplitudes here are arbitrary as no absolute calibration has been attempted. These values are meaningful relative to each other as the product of the amplitude of the primary beam at the declination of the source and the flux of the source (Eq. (\ref{holvis2})). Figure \ref{phaseav} shows the phase recovered from the averaging procedure for Virgo A at a single frequency, feed, and polarisation. We observe sidelobe structure which is similar in the NS direction between sources spanning the range of S/N, and much of the far sidelobe structure is common between high S/N sources. The changing offset from zero hour angle of the peak of the main beam with declination is a known effect, due to the 1.9 degree rotation of the Pathfinder cylinder axis from astronomical North, discussed in Section \ref{ch:hol:sec:io}.

\subsection{Absolute calibration and 2D beam estimation}

\begin{figure}[h!] % not h only
	\centering
	\includegraphics[width=0.92\textwidth]{figures/spie/full2dbeam_thick2.png}%
	\caption{The top four panels: A cartesian projection of the 2D beam estimate for all cylinders and polarisations, in latitude and longitude of telescope coordinates, for a sample feed at 681 MHz. The traces have been artificially thickened, which may misrepresent localized features. These are slices through a full pattern like the model shown in the lower right hand panel. Bottom left: The standard deviations, which vary by several orders of magnitude based on the signal-to-noise of the corresponding source. Bottom right: The full 2D beam amplitude from a simulation of an ideal cylinder at 681 MHz. In all cases the maps have been normalized to the peak value.}
	\label{2dbeamslices}
\end{figure}

To produce the final estimate of the amplitude of the 2D beam at each feed we must divide out the dependence on the flux of the source, corresponding to the $T(\hat{n}_{ps})$ dependence in Eq. (\ref{holvis2}). We do so by referencing to Pathfinder photometry (see Appendix \ref{app:hol:sec:photometry}) and peak-response measurements to obtain the amplitude and phase normalizations, respectively. This ensures that the North-South structure in the beam estimate exactly reflects the on-sky measurements from the visibilities. We therefore require an estimate of the relative fluxes of the point sources in the CHIME band. We combine data from Baars {\it et al.} 1977 \citep{baars}, NVSS \citep{NVSS}, VLSS \citep{VLSS}, 3CRR \citep{3CRR}, and WENSS \citep{WENSS} and perform parametric fits to the spectra of our sources. We adopt a three-parameter model for the spectral flux densities of our sources. We estimate the spectral indices from the data by a maximum likelihood method, incorporating the reported uncertainties on each measurement. The estimated fluxes at $681$ MHz are provided in Table \ref{tab1}.

With the data calibrated, we have now produced an estimate of the two-dimensional beam shape, with a spare sampling in the NS direction (one sample from each source), and dense in the EW direction. In Figure \ref{2dbeamslices}, we show the data for 7 of the sources rotated into telescope coordinates, $(\theta_t, \phi_t)$. This is the spherical polar coordinate system whose origin is zenith and with polar axis aligned with the orientation of the cylinders. In telescope coordinates the beam has maximal symmetry, and so is the natural system for analysis and interpolation (described below). In Figure \ref{2dbeamslices}, we also show the estimated S/N of the slices and a comparison to a numerical electromagnetic simulation of an ideal cylinder.

\begin{figure}[h!]
%\vspace{-.1in}
\begin{center}
\includegraphics[width=1.0\textwidth]{figures/hol_other/beam_freqsel8_summary_v2.png}
\caption{The average beam amplitude, phase, and standard deviation across feeds for the West cylinder NS polarization at 643.4 MHz.\label{example}}
\end{center}
\end{figure}

There are a few orders of magnitude between the S/N of our brightest four sources and the dimmest four. For the brightest sources, thermal noise reaches our target sensitivity \citep{mmodes2} in only a single scan. Clearly we are still noise dominated at large angles in the latter four. We observe correlated sidelobe structure between the brightest sources in the NS direction. Also, there is a large asymmetric sidelobe at small positive $\phi_t$ which correlates between all sources. The NS correlation is only approximate, but this is to be expected since the incoming plane wave strikes the cylinder at different angles, and so probes different sections, depending on the source. The traces in Figure \ref{2dbeamslices} are artificially thickened and so may also misrepresent localized features.

Even the low S/N sources allow us to infer the shape of the main beam with declination. We observe a plateau which extends to about $20^{\circ}$ from zenith, followed by a sharp drop off. This is in accordance with the prediction from our ideal cylinder simulations, discussed in the last subsection. It is clear, from comparison with simulation, that there is much more structure in the NS direction than we have sampled with only 8 sources. However, we see as well that the side lobes observed with holography are an order of magnitude larger that then the ideal simulation. We have confirmed with simulations of a distorted cylinder 

We would now like to interpolate the sparse sampling in declination to produce an estimate of the full two-dimensional beam, for each feed and frequency. The slices are linearly interpolated onto \texttt{healpix} maps using a Delaunay triangulation. The beam is symmetrized about zenith only for sources which would not intersect with actual measurements. HydraA is also linearly extrapolated in the $\phi_t$ to give amplitude 0 at the horizon. The interpolation is forced to zero at the largest telescope azimuth where we have holography data, uniformly for all polar angles. This is done only for feeds and frequencies which can be fit for all of the sources.

The advantage of this technique is that it is \textit{convergent}, in the sense that as more measurements of the NS profile are added it will produce the true beam shape. Furthermore, we have paid special attention to ensure that our gridding and interpolation always sample any possible beam structure conservatively, so that the we obtain the exact measured beam shape at the locations of the sources.

After producing intensity beams at each feed and frequency we then have the option to average across feeds, or stack along redundant baselines. The advantage of averaging is a heavy reduction of computational complexity in generating the beams, the beam transfer matrices, and in mapmaking with the holographic beam. The averaged (by cylinder and polarization) beam is useful for debugging and iterating the pipeline, and gives simple results useful for referencing to attempts at the exact solution. The beam averaged along redundant baselines is indeed the exactly solution when the visibilities are first stacked accordingly as well.

\begin{figure}[h!]
%\vspace{-.1in}
\begin{center}
\includegraphics[width=1.0\textwidth]{figures/hol_other/ns_beam_profile_0-4_v2.png}
\caption{The NS profile of the interpolated holography beams (colored lines), compared the two bounce simulated beam (in grey), for four selected frequencies in the first half of the band. We also show the Pathfinder photometry data (points) which are the nodes of the interpolation. \label{nsprof0}}
\end{center}
\end{figure}

\begin{figure}[h!]
%\vspace{-.1in}
\begin{center}
\includegraphics[width=1.0\textwidth]{figures/hol_other/ns_beam_profile_4-8_v2.png}
\caption{The NS profile of the interpolated holography beams (colored lines), compared the two bounce simulated beam (in grey), for four selected frequencies in the second half of the band. We also show the Pathfinder photometry data (points) which are the nodes of the interpolation. \label{nsprof1}}
\end{center}
\end{figure}

Finally, to produce the beam transfer matrices (see Chapter \ref{chap:mapmaking}) by forming products and performing a Fourier transform from the intensity-only beam functions we've obtained, we require a model for polarization. See Appendix \ref{app:hol:sec:polmodel} for details.

The averaged beam amplitude and phase, normalized to TauA at 643 MHz is shown in Figure \ref{example} below. Substantial side lobes are picked up even in the averaged beam. Some artefacts from the linear interpolation out to the horizon are visible, but with low amplitude. We also show the standard deviation across feeds of the amplitude. We see that it is dominated by the variance in the peak response across feeds, except at the location of the TauA where the amplitude is fixed. The variance in the side lobes is dominated by locations where there is data.

In Figures \ref{nsprof0} and \ref{nsprof1}, we show a comparison of the NS profile of the interpolated holography beams and the simulated ideal beam.

Clearly from Figures \ref{nsprof0} and \ref{nsprof1} we see that normalizing the beam at any source declination (in this case TauA, red dot) is a sensitive choice. In general, the interpolation of the Pathfinder photometry appears to be a good fit for an envelope of the simulated beam. However, one can find instances where it appears that the sparse sampling in declination is smoothing the beam shape. This interpreation is in contrast to Figure \ref{example}, where we see that a shifting and scalling of the oscillatory features leads to variance in the peak amplitude, and washes them out in the average beam.

%\begin{figure}[h!]
%\begin{center}
%\includegraphics[width=.8\textwidth]{figures/hol_other/averaged_slices.png}
%\caption{The single declination slices output from the above algorithm (before smoothing), for a single feed and frequency.}
%\label{example}
%\end{center}
%\end{figure}

\begin{figure}[h!]
%\vspace{-.1in}
\begin{center}
\includegraphics[width=1.0\textwidth]{figures/hol_other/beam_solid_angle_nspol_v2.png}
\caption{The beam solid angle of the NS polarization. \label{bsans}}
\end{center}
\end{figure}

\begin{figure}[h!]
%\vspace{-.1in}
\begin{center}
\includegraphics[width=1.0\textwidth]{figures/hol_other/beam_solid_angle_ewpol_v2.png}
\caption{The beam solid angle of the EW polarization. \label{bsaew}}
\end{center}
\end{figure}

\subsubsection{Beam solid angle}

In Figures \ref{bsans} and \ref{bsaew} we show a comparison between the solid angle of the interpolated holography beam and the simulated two-bounce beam, for the NS and EW polarization, respectively, for 8 selected frequencies which span the band. The solid angle $\Omega$ is defined as
\begin{equation}
\Omega = \int d^2 \hat{n} P_{\rm n}(\hat{n}), \label{Omega}
\end{equation}
where $P_{\rm n}(\hat{n})$ is the normalized power pattern given by
\begin{equation}
P_{\rm n}(\hat{n}) = \frac{P(\theta, \phi)}{\max_{(\theta, \phi)} {P(\theta, \phi)}},
\end{equation}
for $P(\theta, \phi) = |A(\theta, \phi)|^2$ the power pattern, and $A$ the primary beam.

We compute $\Omega$ for the holography beam for three cases: For the main beam (where the main beam is defined as $1.77\lambda/d$),  for regions within $\phi = 30^\circ$ (to mitigate the effect of the interpolation ringing at large angles), and for the full $4\pi$. The difference between the simulated and holography $\Omega$s is a factor $\sim 4$ at the low end of the band to $\sim 10$ at its largest around $500$ MHz.  The side lobes account for about $\sim 30-40\%$ of the measured $\Omega$.

\section{Analysis and Modeling} \label{ch:hol:sec:analysis}

In this section, we discuss some of the basic properties of the beam, in comparison to the fiducial theoretical model and to numerical simulations of an ideal Pathfinder cylinder. In general, the primary beam slices we recover meet our expectation from our 8 sources, in terms of main beam shape and S/N on sidelobe structure. As well, the measured amplitude of each source will broadly show the beam shape dropping off away from the zenith in the NS direction. We will also show evidence for a first-principles model of the beam and describe future directions in improving this technique.

\subsection{Basic considerations}

\begin{figure}[h!] % not h only
	\centering
	\includegraphics[width=0.95\textwidth]{figures/spie/cygawidths_sim.png}%
	\caption{The beam width of the Cygnus A slice as a function of frequency, scaled to account for the declination of the source, for both polarisations of a single feed on the East cylinder. Also plotted are the predictions from numerical simulations of an ideal parabolic cylinder illuminated by a CHIME Pathfinder feed. The dominant mode of the oscillation has a period of $\sim$ 30 MHz, matching the light travel time of twice the 5 m focal length of the Pathfinder. This is a well-known phenomenon in on-axis telescopes \citep{wander1, wander2}. See Figure \ref{26mplot} and also Ref. \citep{wolleben1} for a similar example on the John A. Galt 26m telescope.}
	\label{beamwidths}
\end{figure}

The fiducial theoretical model for the CHIME beam, derived in detail in Ref. \citep{mmodes2}, consists of an ideal parabolic cylinder and dipole at the focus. There are two free parameters, the $E$-plane and $H$-plane FWHM of the dipole, which control the illumination across and along the cylinder. The resulting primary beam is the product of a focused shape in the EW direction, and a long extended shape in the NS direction. This model has maximal symmetry in the telescope coordinate system (whose origin in latitude and longitude is at zenith), which we denote with $(\theta_t, \phi_t)$. In this simple model, the incoming plane wave that reflects only once off of the cylinder to the feed and so predicts a beam FWHM that increases monotonically with wavelength, and whose $E$ and $H$-plane widths determine both the resulting beam width and sidelobe level. These predictions, including the symmetry of the beam, can be broken in the realistic case of a distorted cylinder and interference effects caused by multiple bounces. 

It is well-known \citep{wander1, wander2} that the presence of a standing wave between the focal line and reflective surface causes oscillations in the FWHM and forward gain with frequency. Figure \ref{beamwidths} shows the FWHM of the Cygnus A beam slices as a function of frequency, for both polarisations. Also plotted are the beam widths from electromagnetic numerical simulations of an ideal parabolic cylinder. These simulations include no blockage or distortion effects, but include a model of the CHIME Pathfinder feed \citep{meiling} and interference from a second bounce (see also Figure \ref{full2dbeam}). The FWHM displays a ripple in frequency with a period $\sim$30 MHz, consistent with a standing wave between the focal line and reflective surface. The differing median width between the two polarisations is predicted by the simple differing illumination included in the theoretical model (see Section \ref{ch:hol:sec:io:ss:i}) and our numerical simulations. However we find that the amplitude of the ripple is larger than the simulations would suggest. We also find variations in the telescope pointing with frequency which correspond to the width oscillations. We have run simulations which include both distortions in the cylinder surface and multiple reflective bounces and see similar effects in the results. We are currently investigating this relationship with field tests and further simulations.

We observe clear sidelobe structure which is common between sources at nearby declinations, however the structure can vary with cylinder and polarisation. Since the two polarizations illuminate the cylinder differently, it is not unexpected that the two polarizations may have slightly different sidelobe structure. Similarly, the two cylinders are not identical, and so the sidelobes should be different between them. Again, we see similar broken EW symmetry effects in simulations of a cylinder with an imperfect surface which is itself asymmetric. Furthermore, surface distortion amplifies sidelobes uniformly, to a level which matches that which we observe in the data.

\begin{figure}[t]
\includegraphics[width=\textwidth]{figures/hol_other/CygA-CasA_chid111_compare.png}
\caption{This comparison between raw holographic CygA and CasA data, at few frequencies and a single feed, shows the frequency dependence of the non-Gaussian structure. The first panel shows the spectrum of width oscillation for the 1024 frequencies of the CHIME band. The vertical lines mark the locations of the transits that are shown as a function of hour angle in the bottom four panels. The central panels are taken from the middle of the band while bottom two are from the low end of the band. The bottom left two panels (light colours) are at the minima of the oscillation, and the right two (dark colours) are at the maxima. The non-Gaussian shape is clearly seen in the middle right panel. The CygA and CasA centroids are generally on opposite sides of the 0 hour angle, since they are on opposite sides of zenith, following the centroid shift from the 1.9 degree cylinder rotation.}
\label{cygacasa}
\end{figure} 

\subsubsection{Non-Gaussian Structure}

Analysis of the full-width at half maxima (FHWM) of raw holography data uncovered a non-Gaussian beam artifact. Specifically, the beam artifact is that at particular frequencies near the peaks of the FWHM oscillation, the beams become either flat or double-humped. This is seen only in the East-West polarization beams. Therefore due the frequency dependence and linear polarization of the effect we can be sure it is not due to contamination. Nor does it come from resolving the source: the worst non-Gaussian structure occurs at low frequencies, where the primary beam is widest and the resolution for our 150m baseline is about 17' as compared to 8' at 800 MHz. Furthermore, the effect  is concentrated on boresight. It is present for CygA (declination 40.7) and CasA (declination 58.8), but VirA (declination 12.4) which is far off zenith maintains Gaussian beams throughout its width oscillation. It is seen correspondingly in the in the Pathfinder auto-correlations as well. Finally, the effect doesn't seem to be correlated with telescope structure itself, in the sense that it's not worse or better around legs, towards either edge of the cylinder, or specific to any one cylinder. Its occurrence at the peaks of the FWHM oscillation indicate it's related to the standing wave effect causing the width oscillation. The EW polarisation illuminating more of the cylinder in the NS direction than the NS polarisation could see ``more bounces''. However, attempts to include many bounces have yet failed to reproduce this effect in simulations.

Interestingly, this effect is not seen in Pathfinder ring maps. This can be attributed to the averaging-over-feeds effect that occurs when performing the Fourier transform, washing out the oscillatory structure. We confirmed this by mimicked the steps used to create the ring maps to form a single `holographic' CHIME beam. That is we computed the average:
\begin{equation}
\langle A_i A_j^* \rangle = \sum_i A_i^2 + \sum_{i \neq j} A_iA_j^*
\end{equation}
The results which show good agreement between the two methods are shown in Fig. \ref{formed_beams}.

\begin{figure}[h!]
\includegraphics[width=\textwidth]{figures/hol_other/formed_beams.png}
\caption{Seth provided fits to a CygA transit from his ring maps, with NS and EW polarisation split. This plot compares the resulting FWHM from the slices of the beam formed ring maps to the FWHM from beam formed holography. The EW polarisation ring map fits also show a large amplitude and the flattening of the low end of the oscillation.}
\label{formed_beams}
\end{figure}

\subsection{Full array, redundancy} \label{ch:hol:sec:results:ss:fullarray}

\begin{figure}[h!] % not h only
	\centering
	\begin{subfigure}[b]{0.49\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/westcyl_ns.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.465\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/eastcyl_ns.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.49\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/westcyl_ew.png}%
	\end{subfigure}
	\begin{subfigure}[b]{0.46\textwidth}
		\includegraphics[width=\textwidth]{figures/spie/eastcyl_ew.png}%
	\end{subfigure}
\caption{The averaged amplitude data for all feeds at 681 MHz are over plotted, normalized to the peak of the CygA slice and corrected for coordinates so to trace the shape of the 2D beam. }
\label{allfeeds}
\end{figure}

Figure \ref{allfeeds} shows the averaged amplitude of the beam, one line for each feed of the array, for a single frequency bin at 681 MHz. Much of the of sidelobe structure, even at large angles, is highly correlated across full sets, by cylinder and polarisation. Of course there is some variation within each panel of Figure \ref{allfeeds}, owing to the feeds probing different areas along the cylinder. This spread is larger for the EW polarisation since, as discussed in the previous subsection and Section \ref{ch:hol:sec:io:ss:i}, the ellipticity of the illumination means the EW polarisation sees more of the cylinder.

An advantage of a phased array such as the CHIME pathfinder is the high redundancy of its baselines, due to the placing of the feeds on a regularly spaced grid. This choice, while not ideal for imaging, provides maximal sensitivity for a selected number of spatial Fourier modes. As well, it can greatly simplify the task of calibrating such a large number of antennas \citep{redundantbaselines}, as each redundant baseline should see the same sky. Unfortunately, variations in the primary beam from antenna to antenna break the redundancy to some degree and so complicate this analysis.

One of the biggest advantages of our holographic set up is that a single scan correlates the 26 m reference beam with the entire CHIME Pathfinder array, and so provides high signal-to-noise ratio measurements of each feed individually, at each frequency. Knowledge of the difference between feeds can be used produce an accurate estimate of the true sky modes, restoring the redundancy of the array.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=.8\textwidth]{figures/hol_other/dd_width_Wcyl_Epol.png}
\caption{The beam widths for the 6 sources, for the West cylinder and EW polarisation, as a function of frequency bin and position along the cylinder. White regions are flagged out in various ways during the averaging procedure (RFI frequency mask, by-hand bad channel mask, and bad Gaussian fits). The panels are ordered by decreasing declination, which is shown (rounded to an integer) in the subtitle of each plot. However, the distribution is not symmetric about zenith, with PerB at $3^{\circ}$ off zenith. \newline At high declinations the EW polarisation shows the same scaling with frequency and oscillation we expect, as well as the slightly wider beams we expect, across the cylinder. At low declinations the same structure appears at the south end of the cylinders, although the rippling is faster.}
\label{widthWE}
\end{center}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=.8\textwidth]{figures/hol_other/dd_cen_Wcyl_Npol.png}
\caption{The centroids for 6 sources, for the West cylinder and NS polarisation. White regions are flagged out in various way during the averaging procedure (RFI frequency mask, by-hand bad channel mask, and bad Gaussian fits). The median centroid of each 2D map of the non-flagged data has been removed. The panels are ordered by decreasing declination, which is shown (rounded to an integer) in the subtitle of each plot. Notice the range of the color scale, corresponding to the oscillation in centroid, increases with declination. The large scale variation with feed position is relatively flat, except for a large blue (``more negative than expected") region at the center of the cylinder. The region moves left (to the north) with decreasing declination.}
\label{cenWN}
\end{center}
\end{figure}

To get an overall view of the redundancy of the array, we fit the peak of the averaged holographic visibilities with a three-parameter (centroid, width, and amplitude) Gaussian. We display selected examples of these fits in Figures \ref{widthWE}, and \ref{cenWN}. 

Figure \ref{widthWE} shows the FWHM of the fits for the West cylinder and EW polarization for the entire band and all feeds. This is generally representative of other cylinders and polarizations, displaying the width oscillation in frequency and general constancy across feeds with some structure at low-declinations. This suggests that the FWHM are not sensitive to cylinder distortions, except at low declinations. This cylinder-polarization was chosen because it displays the most structure.

In the centroids we observe large scale structure which is correlated with the cylinder position. We show it for the West cylinder in Figure \ref{cenWN}. The East shows a similar dip, however at a different location (more towards the North edge). The large-scale structure is observed to be unpolarized, while the small scale position-frequency dependent oscillations are polarisation dependent. We also see that the obvious large deviations in centroid in both cylinders move with declination.

\subsection{Evidence for a multi-bounce model}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=.85\textwidth]{figures/hol_other/Unknown.png}
\end{center}
\caption{The geometry of the various bounces we expect to contribute to interference and therefore oscillatory features in frequency.}
\label{unknown}
\end{figure}

A basic two-dimensional Fourier transform of a single high S/N holography beam reveals a complicated multi-peaked structure. These are generally causal and so can be interpreted as second and third bounces contributing to interference effects in the beam. In the previous section we discussed how obvious large deviations in the centroid in both cylinders are seen that move with declination and depend on cylinder, but the location of which is not polarized. If the centroids are sensitive to interference effects, this suggests a corresponding location of a large distortion on the cylinder's surface. Figure \ref{unknown} shows a side view of one cylinder with the 0.3 m-spaced feeds in red, and various possible paths for light rays shown in different colors. 

\begin{figure}[h!]
\begin{center}
\includegraphics[width=.48\textwidth]{figures/hol_other/cyl_rescale.png}
\includegraphics[width=.48\textwidth]{figures/hol_other/width_osc_period_chid10.png}
\caption{Left: The first panel of this figure shows the median centroid across frequency plotted against feed position for the EW polarisation on the West cylinder. This corresponds to a median in the vertical direction of the panels (sources/declinations) of Fig. \ref{cenWN} (but with the median of the whole 2D map restored). The bottom panel shows the same data rescaled to map to the location of the first bounce on a hypothetical infinite cylinder given the declination of the source. The bump corrensponds to a fixed position on the rescaled cylinder (around position 55).
\newline
Right: In blue is the period of a fit to the width oscillation in MHz for 5 different sources, as a function of their declinations (angle from zenith $\theta$ is decreasing along the y-axis). The green line corresponds to the prediction for the period based on the path length difference corresponding to the blue and green lines in Figure \ref{unknown}. This is for a single EW polarisation feed on the East cylinder. \label{confirm}}
\end{center}
\end{figure}

The right panel of Fig. \ref{confirm} confirms that the dip in the centroids maps to a fixed location on the cylinder, by scaling the feed positions for each source to the location of the first bounce (orang line in Figure \ref{unknown}). Also, we observe that the south end of the cylinder develops considerable position-frequency dependent structure (in both widths and centroids) with decreasing declination.

Based on the geometry in Figure \ref{unknown}, the interference which sources the width oscillation could come from three major contributions, each of which would have a different lag/additional path length behavior with declination. The right panel in Fig. \ref{confirm} shows that the period of the width oscillation as a function of angle from zenith fits the additional path length geometry corresponding to the blue case in Fig. \ref{unknown}. In Appendix \ref{app:hol:sec:model}, we provide some mathematical details of how the surface structure is linked to interference effects in the beam.

\section{Simulations} \label{ch:hol:sec:sims}

In this section, we describe the results of simulations conducted to investigate the effect, if any, of various systematics on the holographic signal we measure. In the previous sections, we applied a holography technique to measure the primary beam of a cylindrical transit telescope, which covers a $\sim 1^{\circ}$ strip of the sky and displays non-negligible sidelobe structure. Two primary concerns in evaluating whether the sidelobe structure we observe is accurate is whether it could be contamination from the galaxy, nearby point sources, or effects from resolving the source itself. Eq. (\ref{holvis2}) could be a bad approximation to Eq. (\ref{holvis1}), whose integral extends over the entire sky and so could include contributions other than the point source, or the point source. The primary beam of the tracking dish will have its own sidelobes, which could allow sources at large angles to the primary point source to correlate. Alternatively, we realize that the 26 m-Pathfinder baseline is on the order of 150 m which means that the angular extent of some of our sources could begin to cause frequency dependent effects in the recovered holographic beam. 

Our simulation code uses the publicly available radio cosmology codes \texttt{cora} and \texttt{driftscan}\footnote{https://github.com/radiocosmology/}, which allow for simulation of a fully polarised radio sky and observation thereof by an interferometer in drift scan mode. The problem, for a Pathfinder-like array, is rendered computationally tractable by exploiting the $m$-mode formalism \citep{mmodes1, mmodes2}. We have written an extension to \texttt{driftscan} that allows for simulation of a drifting array in holography mode with a tracking paraboloidal dish. The \texttt{cora} foreground model, described in detail in Ref \citep{mmodes2}, contains a catalogue of known point sources, as well as a Gaussian background of unresolved sources and Galactic model whose intensities are based on Ref. \citep{santoscoorayknox}. The model is then augmented with polarised point source and Galactic emission, and Faraday rotation. In order to properly resolve the scales of a realistic 26 m-Pathfinder baseline we perform our simulations with a \texttt{healpix}\footnote{http://healpix.jpl.nasa.gov/} \citep{gorski} \texttt{nside} of 1024.


\subsection{Extended sources}

\begin{table}[ht]
\caption{Approximate angular extent for the observed point sources.} 
\label{tab2}
\begin{center}
\begin{tabular}{| c  | c |}
\hline
 Source  & extent  \\ \hline
Cygnus A & 1.5' \\ \hline
Cassiopeia A & 4.8' \\ \hline
Taurus A & 7' \\ \hline
Virgo A & 14' \\ \hline
Hydra A & 8' \\ \hline
Perseus B  & 6'' \\ \hline
3C\_295 & 40'' \\ \hline
\end{tabular}
\end{center}
\end{table}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.8\textwidth]{figures/hol_other/pixelized_sources.png}
\caption{Cartesian projections of the high-resolution models of the four simulated sources, at a single frequency, for \texttt{nside} of 4096.}
\label{pixelized_sources}
\end{center}
\end{figure} 

Inspecting our list of sources there are several examples which have angular extent on or near the resolution of our longest 26 m-Pathfinder baseline at 800 Mhz, of about $7'$. We simulate the four brightest point sources: Cygnus A (CygA), Cassiopeia A (CasA), Taurus A (TauA), and Virgo A (VirA). These span the interesting range of angular extent and declination. To construct accurate models of the points sources we perform a pixel-by-pixel logarithmic interpolation between LOFAR ($\sim 200$ MHz) and VLA (1420 MHz) high resolution images of the sources, into the CHIME band. We then downgrade these onto high-resolution \texttt{healpix} maps (usually \texttt{nside} of 4096, although we test 8192 for TauA as well) for input into the simulation software described above. We then rescale maps so that the total integrated flux gives the expected flux based on the fits described in Section \ref{ch:hol:sec:data}. In Figure \ref{pixelized_sources}, we show Cartesian projections of the \texttt{heapix} maps for the four sources at a single frequency, for \texttt{nside} of 4096.

In all cases we observe negligible frequency dependent effects in the recovered shape of the holographic slices. However we do see that over three quarters of the expected flux (in the case of VirA) can be resolved out by the 26 m-Pathfinder baseline, at the high end of the band. These results are shown in Figure \ref{resolved_flux}.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=0.8\textwidth]{figures/hol_other/resolved_flux.png}
\caption{The ratio of holography amplitudes in simulations with high resolution models of the point sources to a single-pixel model with the same integrated flux, shown for the four brightest observed sources as a function of observing cylinder, polarization and frequency.}
\label{resolved_flux}
\end{center}
\end{figure} 

\subsection{Foreground contamination}
Another concern is Galactic or nearby point source contamination in the holographic measurements. To include the effects of the unknown primary beam of the tracking dish (in our case the 26 m), we simulate two noiseless models. The first is a a Gaussian 26 m beam, which therefore has no sidelobes. To include the effects of sidelobes of the tracking dish in a ``worst-case-scenario'' for a holographic measurement, we simulate an ``Exptan beam'' model which refers to the angular dependence of the theoretical illumination of a dipole feed in the aperture plane\citep{mmodes2}. This model consists of a paraboloidal dish with the geometry of the 26 m illuminated by a Pathfinder dipole feed (essentially the dish version of the fiducial Pathfinder beam model). This is a ``worst-case scenario'' as its aperture (owing to the larger focal length of the 26 m) is over-illuminated leading to maximal sidelobes, and so does not reflect the reality of our 26 m setup.

\begin{figure}[h!] % not h only
	\centering	
	\includegraphics[width=0.95\textwidth]{figures/spie/cyga_sim.png}%
	\caption{The amplitudes of the Cygnus A beam slices for the single point source sky and full foreground models, in both cases with the Exptan 26 m beam, at 440 MHz. }
	\label{cygasim}
\end{figure}

Figure \ref{cygasim} shows the results for Cygnus A, which we have simulated at several different frequencies across the band and compare a sky with only one non-zero pixel to the full sky model. Cygnus A is the brightest source in the sky in the CHIME band and so shows the highest S/N sidelobe structure, but nonetheless has significant Galactic flux in its neighborhood. We see no deviation from the single point source slice in all cases.

As one descends in flux of the primary source, the distribution of point sources in the surroundings will change from Poissonian to Gaussian. We have also simulated the two less bright sources, Perseus B, and 3C295, but these are still among the brightest sources in the sky, and so we do not observe deviations between the single point source cases at any level of interest for our observations. To address the question of the minimum flux of primary source permitted for an unbiased measurement of the beam we require an accurate model of the 26 m, which we leave for a later work.

\section{Conclusion} \label{ch:hol:sec:conclusion}

In this chapter, we have described and validated our technique of radio holography of bright astronomical point sources for obtaining high signal-to-noise (S/N) measurements, with good angular resolution, of the two-dimensional primary beams of the CHIME Pathfinder array across its frequency band. We have reported our progress in equipping the John A. Galt 26 m telescope with custom instrumentation for the purpose, and displayed the output of the method for a preliminary data set of 8 sources. We have described the development of a data analysis pipeline which maps these measurements exactly onto the sky, converges to the true beam in the limit of dense declination sampling, and produces beam transfer matrices which are the direct input into the Pathfinder mapmaking software. The recovered beams can then be validated based on their ability to reduce artefacts and correct beam-induced errors seen in maps made with minimal beam information. This discussion is the topic of Chapter \ref{chap:mapmaking}.

In addition to the holography method presented here, CHIME is pursing other methods of filling in the NS beam structure, notably with satellites\citep{hol2, sat2}, drones \citep{drone}, and pulsar holography. In its current form the data presented here serve as a basis for an understanding of the primary beam of a realistic cylindrical telescope array, such as CHIME and its Pathfinder.
